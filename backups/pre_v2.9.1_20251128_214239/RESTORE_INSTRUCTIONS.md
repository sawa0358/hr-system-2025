# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©å…ƒæ‰‹é † (v2.9.1ä»¥å‰ã«æˆ»ã™)

**ä½œæˆæ—¥æ™‚**: 2024å¹´11æœˆ28æ—¥ 21:42:39  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.9.0 â†’ v2.9.1 ç§»è¡Œå‰ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—  
**å¤‰æ›´å†…å®¹**: WorkClockWorkerãƒ†ãƒ¼ãƒ–ãƒ«ã« `transferDestination` (æŒ¯è¾¼å…ˆ) ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 

---

## ğŸ“¦ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å†…å®¹

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

1. **dev.db.backup** - SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒã‚¤ãƒŠãƒªï¼‰
2. **dev.db.sql** - SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®SQLãƒ€ãƒ³ãƒ—ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ï¼‰
3. **schema.prisma.backup** - Prismaã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«
4. **prisma_folder_backup/** - prismaãƒ•ã‚©ãƒ«ãƒ€å…¨ä½“ã®ã‚³ãƒ”ãƒ¼

---

## ğŸ”„ å¾©å…ƒæ–¹æ³•

### æ–¹æ³•1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥å¾©å…ƒï¼ˆæ¨å¥¨ãƒ»æœ€é€Ÿï¼‰

```bash
# 1. ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¿µã®ãŸã‚ï¼‰
cp ./prisma/prisma/dev.db ./prisma/prisma/dev.db.before-restore

# 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cp backups/pre_v2.9.1_20251128_214239/dev.db.backup ./prisma/prisma/dev.db

# 3. ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å¾©å…ƒ
cp backups/pre_v2.9.1_20251128_214239/schema.prisma.backup prisma/schema.prisma

# 4. Prisma Clientã‚’å†ç”Ÿæˆ
npx prisma generate

# 5. ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
npm run dev
```

---

### æ–¹æ³•2: SQLãƒ€ãƒ³ãƒ—ã‹ã‚‰å¾©å…ƒï¼ˆå®Œå…¨å¾©å…ƒï¼‰

```bash
# 1. æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å‰Šé™¤
rm ./prisma/prisma/dev.db

# 2. SQLãƒ€ãƒ³ãƒ—ã‹ã‚‰å¾©å…ƒ
sqlite3 ./prisma/prisma/dev.db < backups/pre_v2.9.1_20251128_214239/dev.db.sql

# 3. ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å¾©å…ƒ
cp backups/pre_v2.9.1_20251128_214239/schema.prisma.backup prisma/schema.prisma

# 4. Prisma Clientã‚’å†ç”Ÿæˆ
npx prisma generate

# 5. ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
npm run dev
```

---

### æ–¹æ³•3: prismaãƒ•ã‚©ãƒ«ãƒ€å…¨ä½“ã‚’å¾©å…ƒï¼ˆæœ€ã‚‚å®‰å…¨ï¼‰

```bash
# 1. ç¾åœ¨ã®prismaãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
mv prisma prisma.before-restore

# 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cp -r backups/pre_v2.9.1_20251128_214239/prisma_folder_backup prisma

# 3. Prisma Clientã‚’å†ç”Ÿæˆ
npx prisma generate

# 4. ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
npm run dev
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **å¾©å…ƒå‰ã«å¿…ãšç¾åœ¨ã®çŠ¶æ…‹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„**
2. å¾©å…ƒå¾Œã¯å¿…ãš `npx prisma generate` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
3. ã‚µãƒ¼ãƒãƒ¼ã‚’å®Œå…¨ã«åœæ­¢ã—ã¦ã‹ã‚‰å¾©å…ƒä½œæ¥­ã‚’è¡Œã£ã¦ãã ã•ã„
4. æœ¬ç•ªç’°å¢ƒï¼ˆHerokuç­‰ï¼‰ã®å¾©å…ƒã¯ã€ã“ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã§ã¯ãªãæœ¬ç•ªç’°å¢ƒã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„

---

## ğŸ” ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®æ¤œè¨¼

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼š

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚µã‚¤ã‚ºã‚’ç¢ºèª
ls -lh backups/pre_v2.9.1_20251128_214239/dev.db.backup

# SQLãƒ€ãƒ³ãƒ—ã®å†…å®¹ã‚’ç¢ºèª
head -20 backups/pre_v2.9.1_20251128_214239/dev.db.sql

# ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç¢ºèª
grep "transferDestination" backups/pre_v2.9.1_20251128_214239/schema.prisma.backup
# â†’ è¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã°æ­£å¸¸ï¼ˆv2.9.0ã®ã‚¹ã‚­ãƒ¼ãƒï¼‰
```

---

## ğŸ“ å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ

1. ã‚µãƒ¼ãƒãƒ¼ã‚’å®Œå…¨ã«åœæ­¢
2. `.next` ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤: `rm -rf .next`
3. `node_modules/.prisma` ã‚’å‰Šé™¤: `rm -rf node_modules/.prisma`
4. ä¸Šè¨˜ã®å¾©å…ƒæ‰‹é †ã‚’å†å®Ÿè¡Œ
5. ãã‚Œã§ã‚‚è§£æ±ºã—ãªã„å ´åˆã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€ç·’ã«å•ã„åˆã‚ã›ã¦ãã ã•ã„

---

**ã“ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯å®‰å…¨ã«ä¿ç®¡ã—ã¦ãã ã•ã„ã€‚**






